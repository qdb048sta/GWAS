log using "C:\TWB_2021\checking_missing.log",replace
import delimited "E:\Data\Gene\TWBR10810-06_Dataland\TWBR10810-06_調查問卷.csv",clear
local varlist="release_no aadq_no follow survey_date id_birth real_birth age sex education marriage dependency native_mom_n native_mom_r native_mom_f native_mom_h native_mom_china native_mom_china_1 native_mom_china_2 native_mom_ab native_mom_ab_1 native_mom_ab_2 native_mom_o native_mom_odc native_fa_n native_fa_r native_fa_f native_fa_h native_fa_china native_fa_china_1 native_fa_china_2 native_fa_ab native_fa_ab_1 native_fa_ab_2 native_fa_o native_fa_odc place_curr place_curr_year place_curr_month place_move place_lgst place_lgst_str place_lgst_end job_experience job_never job_curr job_same job_occupation job_position job_weekly_hrs job_yrs job_months job_lgst_occupation job_lgst_position job_lgst_weekly_hrs job_lgst_yrs job_lgst_months drk drk_quit_age b_drk_yrs b_drk_months drk_quit_yrs drk_quit_months drk_quit_kind drk_quit_a drk_quit_a_other drk_quit_a_freq drk_quit_a_times drk_quit_a_dosage drk_quit_a_unit drk_quit_b drk_quit_b_other drk_quit_b_freq drk_quit_b_times drk_quit_b_dosage drk_quit_b_unit drk_quit_c drk_quit_c_other drk_quit_c_freq drk_quit_c_times drk_quit_c_dosage drk_quit_c_unit drk_curr_age drk_curr_yrs drk_curr_months drk_curr_kind drk_curr_a drk_curr_a_other drk_curr_a_freq drk_curr_a_times drk_curr_a_dosage drk_curr_a_unit drk_curr_b drk_curr_b_other drk_curr_b_freq drk_curr_b_times drk_curr_b_dosage drk_curr_b_unit drk_curr_c drk_curr_c_other drk_curr_c_freq drk_curr_c_times drk_curr_c_dosage drk_curr_c_unit smk_experience smk_sixmonths smk_curr smk_quit_age_1st smk_quit_last_yrs smk_quit_last_months smk_quit_times smk_quit_age smk_quit_health b_smk_yrs b_smk_months b_smk_freq b_smk_pag smk_curr_age_1st smk_curr_last_yrs smk_curr_last_months smk_curr_freq smk_curr_pag smk_amout c_hvy_smk_yrs c_hvy_smk_months c_hvy_smk_freq c_hvy_smk_pag smk_2nd smk_2nd_place1 smk_2nd_place1_hrs smk_2nd_place2 smk_2nd_place2_hrs smk_2nd_place3 smk_2nd_place3_hrs smk_2nd_place4 smk_2nd_place4_hrs nut_experience nut_start_age nut_last_yrs nut_last_months nut_curr nut_quit_yrs nut_quit_months nut_monthly nut_daily b_nut b_nut_freq b_nut_daily nut_kind nut_kind_other spo_habit spo_habit_kind spo_habit_a spo_habit_a_freq spo_habit_a_hrs spo_habit_a_mins spo_habit_b spo_habit_b_freq spo_habit_b_hrs spo_habit_b_mins spo_habit_c spo_habit_c_freq spo_habit_c_hrs spo_habit_c_mins spo_any spo_any_kind spo_any_a spo_any_a_freq spo_any_a_hrs spo_any_a_mins spo_any_b spo_any_b_freq spo_any_b_hrs spo_any_b_mins spo_any_c spo_any_c_freq spo_any_c_hrs spo_any_c_mins spo_note wet_light wet_hvy wet_hvy_age1 wet_hvy_age2 wet_hvy_age3 wet_hvy_age4 wet_hvy_age5 wet_change_same wet_change_d wet_change_i wet_d_hvy wet_d_light wet_i_hvy wet_i_light wet_control wet_control1 wet_control2 wet_control3 wet_control4 wet_control5 wet_control6 wet_control7 wet_control8 wet_control9 wet_control10 wet_control11 wet_control12 wet_control13 drug_use drug_kind drug_kind_a drug_name_a drug_a_freq drug_a_times drug_a_dosage drug_a_unit drug_a_other drug_kind_b drug_name_b drug_b_freq drug_b_times drug_b_dosage drug_b_unit drug_b_other drug_kind_c drug_name_c drug_c_freq drug_c_times drug_c_dosage drug_c_unit drug_c_other drug_name_d drug_d_freq drug_d_times drug_d_dosage drug_d_unit drug_d_other drug_name_e drug_e_freq drug_e_times drug_e_dosage drug_e_unit drug_e_other sleep_d_hrs sleep_d_time sleep_w_hrs sleep_w_time sleep_quality ill_act ill_other cook_sixthmonths cook_curr cook_last_sixthmonths cook_age_start cook_age_end cook_freq cook_times cook_way cook_fuel cook_fuel_other cook_oil cook_oil_other cook_hood cook_hood_yrs incense_curr incense_kind incense_a incense_a_hurs incense_b incense_b_hurs incense_c incense_c_hurs water_place water_place_other water_origin water_origin_other water_origin_yrs water_daily water_boiled d_1 d_2 d_3 d_4 d_5 d_6 d_7 d_8 d_9 d_10 d_11 d_12 d_13 d_14 d_15 d_16 d_17 tea tea_kind tea_a tea_a_freq tea_a_times tea_a_unit tea_b tea_b_freq tea_b_times tea_b_unit tea_c tea_c_freq tea_c_times tea_c_unit coffee coffee_kind coffee_a coffee_a_freq coffee_a_times coffee_a_unit coffee_b coffee_b_freq coffee_b_times coffee_b_unit coffee_c coffee_c_freq coffee_c_times coffee_c_unit vege vege_kind vege_yrs meal_times snake snake_freq out_eat supp supp_kind supp_a supp_a_freq supp_a_times supp_a_dosage supp_a_unit supp_a_unit_other supp_b supp_b_freq supp_b_times supp_b_dosage supp_b_unit supp_b_unit_other supp_c supp_c_freq supp_c_times supp_c_dosage supp_c_unit supp_c_unit_other supp_d supp_d_freq supp_d_times supp_d_dosage supp_d_unit supp_d_unit_other supp_e supp_e_freq supp_e_times supp_e_dosage supp_e_unit supp_e_unit_other menarche mess_reg mess_period mess_curr menopause mp_reason mp_reason_other pregnancy preg_times preg_age_1st preg_age_final birth birth_times birth_age_1st birth_age_final abortion abo_times induce_abo_times natural_abo_times breast_milk parity parity_1_months parity_2_months parity_3_months parity_4_months parity_5_months parity_6_months parity_7_months parity_8_months hormome_med homo_1 homo_1_yrs homo_1_months homo_2 homo_2_yrs homo_2_months homo_3 homo_3_yrs homo_3_months homo_4 homo_4_yrs homo_4_months homo_6 homo_6_yrs homo_6_months homo_5 homo_5_yrs homo_5_months herbal_med herbal_1 herbal_1_yrs herbal_1_months herbal_2 herbal_2_yrs herbal_2_months herbal_3 herbal_3_yrs herbal_3_months herbal_4 herbal_4_yrs herbal_4_months herbal_5 herbal_5_yrs herbal_5_months f_supp f_supp_1 f_supp_1_yrs f_supp_1_months f_supp_2 f_supp_2_yrs f_supp_2_months f_supp_3 f_supp_3_yrs f_supp_3_months f_no_disease dys dys_self dys_self_year dys_self_month dys_mom dys_sis dys_sis_p myoma myo_self myo_self_year myo_self_month myo_mom myo_sis myo_sis_p ovarian_cyst ova_self ova_self_year ova_self_month ova_mom ova_sis ova_sis_p endometriosis endo_self endo_self_year endo_self_month endo_mom endo_sis endo_sis_p cervical_polyp cervical_p_self cervical_p_self_year cervical_p_self_month cervical_p_mom cervical_p_sis cervical_p_sis_p uterine_cancer uter_self uter_self_year uter_self_month uter_mom uter_sis uter_sis_p cervical_cancer cer_self cer_self_year cer_self_month cer_mom cer_sis cer_sis_p ovarian_cancer ovacan_self ovacan_self_year ovacan_self_month ova_cancer_mom ova_cancer_sis ova_cancer_sis_p g_1 g_1_a g_2 g_3 g_4 g_5 g_5_a g_5_b g_5_c sentence g_5_d g_5_e income_self income_family i_0 i_1 i_2 i_3 i_4 i_5 i_6 i_7 i_8 i_9 i_10 i_11 i_12 i_13 i_14 i_15 i_16 i_17 i_18 i_19 i_20 i_21 i_22 i_23 i_24 i_25 i_26 i_27 i_28 i_29 i_30 i_31 i_32 i_33 i_34 i_35 i_36 i_37 i_38 i_39 i_40 i_41 i_42 i_43 i_44"
foreach k of local varlist{
    display "`k'"
	count if missing(`k')
}

import delimited "E:\Data\Gene\TWBR10810-06_Dataland\TWBR10810-06_健康問卷.csv",clear
local varlist="release_no aadq_no follow allergic allergic_self allergic_self_med allergic_self_year allergic_self_month allergic_fa allergic_fa_med allergic_mom allergic_mom_med allergic_bro allergic_bro_med allergic_bro_p allergic_sis allergic_sis_med allergic_sis_p orthopedics_or_articulus osteoporosis osteoporosis_self osteoporosis_self_year osteoporosis_self_month osteoporosis_fa osteoporosis_mom osteoporosis_bro osteoporosis_bro_p osteoporosis_sis osteoporosis_sis_p arthritis arthritis_self arthritis_self_kind arthritis_self_year arthritis_self_month arthritis_fa arthritis_fa_kind arthritis_mom arthritis_mom_kind arthritis_bro arthritis_bro_kind arthritis_bro_p arthritis_sis arthritis_sis_kind arthritis_sis_p gout gout_self gout_self_year gout_self_month gout_fa gout_mom gout_bro gout_bro_p gout_sis gout_sis_p lung_and_respiratory asthma asthma_self asthma_self_year asthma_self_month asthma_fa asthma_mom asthma_bro asthma_bro_p asthma_sis asthma_sis_p emphysema_or_bronchitis emphysema_or_bronchitis_self emphysema_or_bronchitis_self_yea emphysema_or_bronchitis_self_mon emphysema_or_bronchitis_fa emphysema_or_bronchitis_mom emphysema_or_bronchitis_bro emphysema_or_bronchitis_bro_p emphysema_or_bronchitis_sis emphysema_or_bronchitis_sis_p heart_and_blood_tube valve_heart_dis valve_heart_dis_self valve_heart_dis_self_year valve_heart_dis_self_month valve_heart_dis_fa valve_heart_dis_mom valve_heart_dis_bro valve_heart_dis_bro_p valve_heart_dis_sis valve_heart_dis_sis_p coronary_artery_dis coronary_artery_dis_self coronary_artery_dis_self_year coronary_artery_dis_self_month coronary_artery_dis_fa coronary_artery_dis_mom coronary_artery_dis_bro coronary_artery_dis_bro_p coronary_artery_dis_sis coronary_artery_dis_sis_p arrhythmia arrhythmia_self arrhythmia_self_year arrhythmia_self_month arrhythmia_fa arrhythmia_mom arrhythmia_bro arrhythmia_bro_p arrhythmia_sis arrhythmia_sis_p cardiomyopathy cardiomyopathy_self cardiomyopathy_self_year cardiomyopathy_self_month cardiomyopathy_fa cardiomyopathy_mom cardiomyopathy_bro cardiomyopathy_bro_p cardiomyopathy_sis cardiomyopathy_sis_p congenital_heart_dis congenital_heart_dis_self congenital_heart_dis_self_year congenital_heart_dis_self_month congenital_heart_dis_fa congenital_heart_dis_mom congenital_heart_dis_bro congenital_heart_dis_bro_p congenital_heart_dis_sis congenital_heart_dis_sis_p other_heart_dis other_heart_dis_self other_heart_dis_self_kind other_heart_dis_self_year other_heart_dis_self_month other_heart_dis_fa other_heart_dis_fa_kind other_heart_dis_mom other_heart_dis_mom_kind other_heart_dis_bro other_heart_dis_bro_kind other_heart_dis_bro_p other_heart_dis_sis other_heart_dis_sis_kind other_heart_dis_sis_p hyperlipidemia hyperlipidemia_self hyperlipidemia_self_year hyperlipidemia_self_month hyperlipidemia_fa hyperlipidemia_mom hyperlipidemia_bro hyperlipidemia_bro_p hyperlipidemia_sis hyperlipidemia_sis_p hypertension hypertension_self hypertension_self_year hypertension_self_month hypertension_fa hypertension_mom hypertension_bro hypertension_bro_p hypertension_sis hypertension_sis_p apoplexia apoplexia_self apoplexia_self_year apoplexia_self_month apoplexia_fa apoplexia_mom apoplexia_bro apoplexia_bro_p apoplexia_sis apoplexia_sis_p diabetes diabetes_self diabetes_self_kind diabetes_self_year diabetes_self_month diabetes_fa diabetes_fa_kind diabetes_mom diabetes_mom_kind diabetes_bro diabetes_bro_kind diabetes_bro_p diabetes_sis diabetes_sis_kind diabetes_sis_p alimentary_canal peptic_ulcer peptic_ulcer_self peptic_ulcer_self_year peptic_ulcer_self_month peptic_ulcer_fa peptic_ulcer_mom peptic_ulcer_bro peptic_ulcer_bro_p peptic_ulcer_sis peptic_ulcer_sis_p gastroesophagea_reflux gerd_self gerd_self_year gerd_self_month gerd_fa gerd_mom gerd_bro gerd_bro_p gerd_sis gerd_sis_p irritable_bowel_syndrome ibs_self ibs_self_year ibs_self_month ibs_fa ibs_mom ibs_bro ibs_bro_p ibs_sis ibs_sis_p psychosis depression depression_self depression_self_year depression_self_month depression_fa depression_mom depression_bro depression_bro_p depression_sis depression_sis_p manic_depression manic_depression_self manic_depression_self_year manic_depression_self_month manic_depression_fa manic_depression_mom manic_depression_bro manic_depression_bro_p manic_depression_sis manic_depression_sis_p postpartum_depression postpartum_depression_self postpartum_depression_self_year postpartum_depression_self_month postpartum_depression_mom postpartum_depression_sis postpartum_depression_sis_p obsessive_compulsive_disorder ocd_self ocd_self_year ocd_self_month ocd_fa ocd_mom ocd_bro ocd_bro_p ocd_sis ocd_sis_p alcoholism_drug_addiction alcoholism_drug_addiction_self alcoholism_drug_addiction_self_y alcoholism_drug_addiction_self_m alcoholism_drug_addiction_fa alcoholism_drug_addiction_mom alcoholism_drug_addiction_bro alcoholism_drug_addiction_bro_p alcoholism_drug_addiction_sis alcoholism_drug_addiction_sis_p schizophrenia schizophrenia_self schizophrenia_self_year schizophrenia_self_month schizophrenia_fa schizophrenia_mom schizophrenia_bro schizophrenia_bro_p schizophrenia_sis schizophrenia_sis_p nervous_systerm epilepsy epilepsy_self epilepsy_self_year epilepsy_self_month epilepsy_fa epilepsy_mom epilepsy_bro epilepsy_bro_p epilepsy_sis epilepsy_sis_p hemicrania hemicrania_self hemicrania_self_year hemicrania_self_month hemicrania_fa hemicrania_mom hemicrania_bro hemicrania_bro_p hemicrania_sis hemicrania_sis_p multiple_sclerosis ms_self ms_self_year ms_self_month ms_fa ms_mom ms_bro ms_bro_p ms_sis ms_sis_p parkison parkison_self parkison_self_year parkison_self_month parkison_fa parkison_mom parkison_bro parkison_bro_p parkison_sis parkison_sis_p dementia dementia_self dementia_self_year dementia_self_month dementia_fa dementia_mom dementia_bro dementia_bro_p dementia_sis dementia_sis_p others liver_gall_stone liver_gall_stone_self liver_gall_stone_self_year liver_gall_stone_self_month liver_gall_stone_fa liver_gall_stone_mom liver_gall_stone_bro liver_gall_stone_bro_p liver_gall_stone_sis liver_gall_stone_sis_p kidney_stone kidney_stone_self kidney_stone_self_year kidney_stone_self_month kidney_stone_fa kidney_stone_mom kidney_stone_bro kidney_stone_bro_p kidney_stone_sis kidney_stone_sis_p renal_failure renal_failure_self renal_failure_self_year renal_failure_self_month renal_failure_fa renal_failure_mom renal_failure_bro renal_failure_bro_p renal_failure_sis renal_failure_sis_p vertigo vertigo_self vertigo_self_year vertigo_self_month vertigo_fa vertigo_mom vertigo_bro vertigo_bro_p vertigo_sis vertigo_sis_p carcinoma_in_situ liver_cancer liver_cancer_self liver_cancer_s_year liver_cancer_s_month liver_cancer_fa liver_cancer_mom liver_cancer_bro liver_cancer_bro_p liver_cancer_sis liver_cancer_sis_p lung_cancer lung_cancer_self lung_cancer_s_year lung_cancer_s_month lung_cancer_fa lung_cancer_mom lung_cancer_bro lung_cancer_bro_p lung_cancer_sis lung_cancer_sis_p breast_cancer breast_cancer_self breast_cancer_s_year breast_cancer_s_month breast_cancer_fa breast_cancer_mom breast_cancer_bro breast_cancer_bro_p breast_cancer_sis breast_cancer_sis_p gastric_cancer gastric_cancer_self gastric_cancer_s_year gastric_cancer_s_month gastric_cancer_fa gastric_cancer_mom gastric_cancer_bro gastric_cancer_bro_p gastric_cancer_sis gastric_cancer_sis_p colorectal_cancer colorectal_can_self colorectal_can_s_year colorectal_can_s_month colorectal_cancer_fa colorectal_cancer_mom colorectal_cancer_bro colorectal_cancer_bro_p colorectal_cancer_sis colorectal_cancer_sis_p nasopharyngeal_cancer nasopharyngeal_can_self nasopharyngeal_can_s_year nasopharyngeal_can_s_month nasopharyngeal_cancer_fa nasopharyngeal_cancer_mom nasopharyngeal_cancer_bro nasopharyngeal_cancer_bro_p nasopharyngeal_cancer_sis nasopharyngeal_cancer_sis_p prostate_cancer prostate_cancer_self prostate_cancer_s_year prostate_cancer_s_month prostate_cancer_fa prostate_cancer_bro prostate_cancer_bro_p cancer_other cancer_other_self cancer_other_s_name cancer_other_s_year cancer_other_s_month cancer_other_fa cancer_other_fa_name cancer_other_mom cancer_other_mom_name cancer_other_bro cancer_other_bro_name cancer_other_bro_p cancer_other_sis cancer_other_sis_name cancer_other_sis_p ache articulus_ache articulus_ache_freq neck_ache neck_ache_freq back_and_waist_ache back_and_waist_ache_freq sicatica sicatica_freq headache_and_hemicrania headache_and_hemicrania_freq headache_a headache_b headache_c headache_d dysmenorrhea dysmenorrhea_freq ache_other ache_other_1 ache_other_1_freq ache_other_2 ache_other_2_freq ache_other_3 ache_other_3_freq ache_other_4 ache_other_4_freq eye_dis cataract cataract_r cataract_l glucoma glucoma_r glucoma_l xerophthalmia xerophthalmia_r xerophthalmia_l rentinal_detachment rentinal_detachment_r rentinal_detachment_l floaters floaters_r floaters_l blind blind_r blind_l color_blind color_blind_r color_blind_l eye_dis_other eye_dis_other_1 eye_dis_other_1_r eye_dis_other_1_l eye_dis_other_2 eye_dis_other_2_r eye_dis_other_2_l phq1 phq2 phq3 phq4"
foreach k of local varlist{
    display"`k''"
	count if missing(`k')
}
import delimited "E:\Data\Gene\TWBR10810-06_Dataland\TWBR10810-06_檢體檢驗.csv",clear
local varlist="release_no aadq_no follow measure_pose body_height body_weight body_fat_rate body_waistline body_buttocks clothing_upper clothing_lower body_note measure_pressure_pose sit_1_systolic_pressure sit_1_diastolic_pressure sit_2_systolic_pressure sit_2_diastolic_pressure sit_3_systolic_pressure sit_3_diastolic_pressure sit_1_heartbeat_speed sit_2_heartbeat_speed sit_3_heartbeat_speed blood_note measure_bone_pose bone_exam_result young_adult t_score age_matched z_score bua sos bone_note interpretation vc vc_pred tv erv irv ic vc_ht fvc fvc_pred fev10 fev10_pred fev10_fvc fev10_fvc_pred fev10_svc fev10_vcpr mmf mmf_pred pef pef_pred fef25 fef25_pred fef50 fef50_pred fef75 fef75_pred fef75_ht fef75_ht_pred extrapv_p fiv10_fvc lung_function_note draw_date draw_time meal_date meal_time fast_time fast_note rbc wbc hb hct platelet hba1c rbc_ref_1 rbc_ref_2 wbc_ref_1 wbc_ref_2 hb_ref_1 hb_ref_2 hct_ref_1 hct_ref_2 platelet_ref_1 platelet_ref_2 hba1c_ref_1 hba1c_ref_2 anti_hcv_ab_1 anti_hcv_ab_2 hbsag_1 hbsag_2 hbeag_1 hbeag_2 anti_hbs_ab_1 anti_hbs_ab_2 anti_hbc_ab_1 anti_hbc_ab_2 anti_hcv_ab_1_ref_1 hbsag_1_ref_1 hbeag_1_ref_1 anti_hbc_ab_1_ref_1 eeq_anti_hbcab_hbeag fasting_glucose t_cho tg hdl_c ldl_c ac_glucose_ref_1 ac_glucose_ref_2 t_cho_ref_1 tg_ref_1 hdl_c_ref_1 ldl_c_ref_1 t_bilirubin albumin sgot sgpt afp gamma_gt t_bilirubin_ref_1 t_bilirubin_ref_2 albumin_ref_1 albumin_ref_2 sgot_ref_1 sgot_ref_2 sgpt_ref_1 sgpt_ref_2 afp_ref_1 gamma_gt_ref_1 gamma_gt_ref_2 bun creatinine uric_acid bun_ref_1 bun_ref_2 creatinine_ref_1 creatinine_ref_2 uric_acid_ref_1 microalb microalb_ref_1 urine_microalb_note"
foreach k of local varlist{
    display"`k''"
	count if missing(`k')
}
import delimited "E:\Data\Gene\TWBR10810-06_Dataland\TWBR10810-06_加值實驗.csv",clear
local varlist "release_no aadq_no twb1_id twb1_batch twb2_id twb2_batch sample_name platform methyl_id hla_id"
foreach k of local varlist{
    display"`k''"
	count if missing(`k')
}
log close

clear
import delimited "E:\Data\Gene\TWBR10810-06_Dataland\TWBR10810-06_調查問卷.csv",clear
save "C:\TWB_2021\survey.dta",replace

import delimited "E:\Data\Gene\TWBR10810-06_Dataland\TWBR10810-06_健康問卷.csv",clear
merge 1:1 release_no aadq_no survey_date using "C:\TWB_2021\survey.dta"
keep if _merge==3
drop _merge
save "C:\TWB_2021\survey_health.dta",replace

import delimited "E:\Data\Gene\TWBR10810-06_Dataland\TWBR10810-06_檢體檢驗.csv",clear
merge 1:1 release_no aadq_no  survey_date using "C:\TWB_2021\survey_health.dta"
keep if _merge==3
drop _merge
save "C:\TWB_2021\survey_health_sample.dta",replace

import delimited "E:\Data\Gene\TWBR10810-06_Dataland\TWBR10810-06_加值實驗.csv",clear
merge 1:1 release_no aadq_no survey_date using "C:\TWB_2021\survey_health_sample.dta"
keep if _merge==3
drop _merge
save "C:\TWB_2021\survey_health_sample_valueadd.dta",replace

